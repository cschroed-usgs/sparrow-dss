#
# These queries are some basic data validation checks that should return
# Zero rows for each model if the data is good.
#
CheckNullEnhReach = select MODEL_REACH_ID from model_reach where sparrow_model_id = $MODEL_ID$ and enh_reach_id is null and ROWNUM < 10

CheckNullCalculationAttribs = select reach.IDENTIFIER from model_reach_attrib attrib INNER JOIN MODEL_REACH reach ON attrib.MODEL_REACH_ID = reach.MODEL_REACH_ID \
	where reach.SPARROW_MODEL_ID = $MODEL_ID$ and (attrib.meanq is null OR attrib.CATCH_AREA = null) and ROWNUM < 10
	
CheckNullHucAttribs = select reach.IDENTIFIER from model_reach_attrib attrib INNER JOIN MODEL_REACH reach ON attrib.MODEL_REACH_ID = reach.MODEL_REACH_ID \
	where reach.SPARROW_MODEL_ID = $MODEL_ID$ and \
	(attrib.HUC2 is null OR attrib.HUC4 = null OR attrib.HUC6 = null OR attrib.HUC8 = null) and ROWNUM < 10
	
CheckForMissingAttributeRows = select model_reach_id, IDENTIFIER FROM MODEL_REACH \
	WHERE sparrow_model_id = $MODEL_ID$ and model_reach_id NOT IN ( \
	select model_reach_id from model_reach_attrib ) and ROWNUM < 10
	
CheckForNullTerminations = select reach.IDENTIFIER \
	from model_reach_attrib attrib INNER JOIN MODEL_REACH reach ON attrib.MODEL_REACH_ID = reach.MODEL_REACH_ID \
	where reach.SPARROW_MODEL_ID = $MODEL_ID$ and \
	(attrib.SHORE_REACH IS NULL OR attrib.TERM_TRANS IS NULL OR attrib.TERM_ESTUARY IS NULL OR attrib.TERM_NONCONNECT IS NULL) and \
	ROWNUM < 10
	
CheckForNullGeometry = Select IDENTIFIER \
FROM model_geom_vw \
WHERE (reach_geom is null OR catch_geom is null) and sparrow_model_id = $MODEL_ID$

CheckForDuplicateEnhIdsWithNoModelReachGeom= Select COUNT(ENH_REACH_ID) \
FROM model_reach \
WHERE sparrow_model_id = $MODEL_ID$ AND MODEL_REACH_ID NOT IN ( \
	SELECT g.MODEL_REACH_ID FROM MODEL_REACH_GEOM g INNER JOIN MODEL_REACH r ON g.MODEL_REACH_ID = r.MODEL_REACH_ID WHERE sparrow_model_id = $MODEL_ID$ \
) \
GROUP BY ENH_REACH_ID \
HAVING COUNT(ENH_REACH_ID) > 1 \